---
title: 家用 NAS 折腾记
date: 2024-11-27 04:34:40
tags: [HomeLab]
draft: true
---

# 家用 NAS 折腾记

## 前言

    每位 Minecraft 玩家最终都会走上 HomeLab 的不归路。

从初中开始，我就幻想着拥有一台自己的服务器，部署一些服务，囿于各种限制，迟迟未能实现。时过境迁，在2023年，我的室友`阿珑`[玩起了 NAS](https://www.bilibili.com/video/BV1o24y1K7mh/?spm_id_from=333.999.0.0)，这对我造成了不小的震撼，遂下决心，要搞一台自己的 NAS。

历尽千辛万苦，我得到了比较满意的方案，写此文以记之。本文会从软硬件多方面进行详细的介绍，希望对正在看这篇文章的你有所帮助。

## 硬件

硬件对于我来说是最艰难的一步，不仅仅是因为平时没有接触这方面的经验，更因为硬件的种类繁多，经常挑花了眼。

## 综述

该小节会介绍现有的协议，分析其优劣。

### FTP

最经典的文件传输协议，具有较好的跨平台性，通用性强；支持断点续传和多文件同时上传

**缺点：**

由于FTP在传输过程中默认使用明文传输，因此安全性较低

### SMB

Windows 系统开箱即用的协议，在内网中使用体验非常 Nice。如果你是在**内网**的 Windows 上使用，可以考虑此协议。

**缺点：**

由于过于普及，经常爆出漏洞，若 NAS 中保存了一些隐私数据，那么我非常不建议把 SMB 协议暴露在外网中使用。

### NFS

NFS 协议，是 Linux 内核默认支持的文件传输协议，具有不错的性能，但是没有鉴权功能，因此只能在内网中使用。如果你是在**内网**的 Linux 上使用，可以考虑此协议。

### WebDAV

WebDav 基于 HTTP 协议，默认是明文传输，安全性较低，所以在实际使用时会再套一层 TLS 协议，可以有效抵御中间人攻击。

### SFTP

基于 SSH 的文件传输协议，牺牲了一部分性能，换来了非凡的安全性。

## 我的方案

最后我选择了 SFTP 协议，虽然性能比较低，但是考虑到我主要是远程使用，网速比较慢，在实际使用时根本不会达到 SSH 的性能瓶颈，所以这是最适合我的一种方案，如果你也是远程使用，可以考虑这个方案。

我选择使用 SFTPGo 来创建 SFTP Service，因为他提供了 WebUI，可以很方便地远程管理用户和密钥。

SFTPGo 提供了几种安装方式，对我而言最适合的就是使用 Docker 部署。

### 使用 SFTPGo 创建 SFTP 服务

### 使用 Rclone 挂载 SFTP

诚然，市面上有很多挂载工具，例如大名鼎鼎的 RaiDrive，但是有广告，而且有限制，只能挂载有限数量的网盘，因此我使用了一段时间后，最终选择切换到 Rclone。

如果你比较讨厌命令行，那么真心推荐 RaiDrive，除了上述两个缺点，基本可以满足大部分日常使用的需求。

话不多说，开始折腾 Rclone！

```sh
Rclone mount truenas-main-sftp:/mnt Z:
```
